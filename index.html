<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wire Transfer Request Â· Onix Capital</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: Arial, sans-serif; background: #f4f2ee; min-height: 100vh; padding: 40px 16px 60px; }
  .container { width: 100%; max-width: 640px; margin: 0 auto; }
  .header { text-align: center; margin-bottom: 32px; }
  .logo-mark { width: 48px; height: 48px; background: #1a1a2e; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 12px; }
  .logo-mark span { color: #c9a84c; font-size: 20px; font-weight: bold; }
  .header h1 { font-size: 22px; color: #1a1a2e; font-weight: normal; }
  .header p { font-size: 13px; color: #888; margin-top: 6px; }
  .card { background: white; border-radius: 12px; padding: 32px; box-shadow: 0 2px 20px rgba(0,0,0,0.07); margin-bottom: 16px; }
  .section-title { font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: #c9a84c; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #f0ece4; margin-top: 28px; }
  .section-title:first-child { margin-top: 0; }
  .payer-box { background: #faf9f7; border: 1.5px solid #e8e4dc; border-radius: 8px; padding: 12px 14px; margin-bottom: 18px; font-size: 13px; color: #555; }
  .payer-box strong { color: #1a1a2e; display: block; margin-bottom: 2px; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; }
  .field-group { margin-bottom: 16px; }
  label { display: block; font-size: 12px; color: #555; margin-bottom: 5px; font-weight: 600; }
  input, select { width: 100%; padding: 11px 14px; border: 1.5px solid #e8e4dc; border-radius: 8px; font-size: 14px; color: #1a1a2e; background: #faf9f7; outline: none; -webkit-appearance: none; appearance: none; }
  input:focus, select:focus { border-color: #c9a84c; background: white; }
  input::placeholder { color: #bbb; }
  .row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .disclaimer { background: #fffbf0; border: 1.5px solid #e8d98a; border-radius: 8px; padding: 14px 16px; margin-bottom: 18px; font-size: 12px; line-height: 1.6; color: #555; }
  .disclaimer strong { color: #1a1a2e; display: block; margin-bottom: 4px; }
  .submit-btn { width: 100%; padding: 15px; background: #1a1a2e; color: white; border: none; border-radius: 8px; font-size: 15px; cursor: pointer; }
  .submit-btn:hover { background: #2a2a4e; }
  .submit-btn:disabled { background: #999; cursor: not-allowed; }
  .error-msg { background: #fff3f3; border: 1px solid #fcc; border-radius: 6px; padding: 10px 14px; font-size: 13px; color: #c0392b; margin-top: 12px; display: none; }
  .success-screen { display: none; text-align: center; padding: 40px 24px; }
  .success-icon { width: 64px; height: 64px; background: #e8f5e9; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 16px; font-size: 28px; }
  .success-screen h2 { font-size: 22px; color: #1a1a2e; font-weight: normal; margin-bottom: 10px; }
  .success-screen p { font-size: 14px; color: #666; line-height: 1.6; margin-bottom: 8px; }
  .ref-box { display: inline-block; background: #f4f2ee; border: 1px solid #e0dbd0; border-radius: 6px; padding: 8px 20px; font-family: monospace; font-size: 15px; color: #1a1a2e; margin: 16px 0 20px; letter-spacing: 1px; }
  .summary-table { width: 100%; border-collapse: collapse; text-align: left; margin: 16px 0; font-size: 13px; }
  .summary-table td { padding: 8px 12px; border-bottom: 1px solid #f0ece4; color: #444; }
  .summary-table td:first-child { color: #888; width: 45%; font-size: 12px; }
  .invoice-notice { background: #fffbf0; border: 1.5px solid #e8d98a; border-radius: 8px; padding: 14px 16px; margin: 16px 0 20px; font-size: 13px; line-height: 1.6; color: #555; text-align: left; }
  .invoice-notice strong { color: #1a1a2e; display: block; margin-bottom: 4px; }
  .new-btn { padding: 12px 32px; background: transparent; color: #1a1a2e; border: 1.5px solid #1a1a2e; border-radius: 8px; font-size: 14px; cursor: pointer; }
  .new-btn:hover { background: #1a1a2e; color: white; }
  .spinner { display: inline-block; width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.4); border-top-color: white; border-radius: 50%; animation: spin 0.7s linear infinite; vertical-align: middle; margin-right: 8px; }
  @keyframes spin { to { transform: rotate(360deg); } }
  @media (max-width: 480px) { .row-2 { grid-template-columns: 1fr; } .card { padding: 20px 16px; } }
</style>
</head>
<body>
<div class="container">

  <div class="header">
    <div class="logo-mark"><span>O</span></div>
    <h1>Wire Transfer Request</h1>
    <p>Onix Capital Partners Â· Solicitud de Transferencia Bancaria</p>
  </div>

  <div class="card" id="formCard">

    <div class="section-title">Payer / Pagador</div>
    <div class="payer-box">
      <strong>Payer / Pagador</strong>Verdi Square Asset Management SL
    </div>

    <div class="section-title">Transfer Details / Detalle de Transferencia</div>
    <div class="row-2">
      <div class="field-group">
        <label>Amount / Importe *</label>
        <input type="number" id="amount" placeholder="0.00" step="0.01" min="0.01">
      </div>
      <div class="field-group">
        <label>Currency / Divisa *</label>
        <select id="currency">
          <option value="EUR">EUR â€“ Euro</option>
          <option value="USD">USD â€“ US Dollar</option>
          <option value="GBP">GBP â€“ British Pound</option>
          <option value="CHF">CHF â€“ Swiss Franc</option>
        </select>
      </div>
    </div>
    <div class="field-group">
      <label>Beneficiary Name / Beneficiario *</label>
      <input type="text" id="beneficiario" placeholder="Full legal name of recipient">
    </div>
    <div class="field-group">
      <label>Beneficiary Address / DirecciÃ³n del Beneficiario *</label>
      <input type="text" id="dirBeneficiario" placeholder="Full address">
    </div>

    <div class="section-title">Bank Details / Datos Bancarios</div>
    <div class="row-2">
      <div class="field-group">
        <label>Correspondent Bank / Banco Intermediario</label>
        <input type="text" id="bancoIntermediario" placeholder="e.g. JPMorgan Chase">
      </div>
      <div class="field-group">
        <label>City / Ciudad</label>
        <input type="text" id="ciudadIntermediario" placeholder="e.g. New York">
      </div>
    </div>
    <div class="row-2">
      <div class="field-group">
        <label>Swift (Correspondent)</label>
        <input type="text" id="swiftIntermediario" placeholder="e.g. CHASUS33">
      </div>
      <div class="field-group">
        <label>ABA / Routing</label>
        <input type="text" id="aba" placeholder="e.g. 021000021">
      </div>
    </div>
    <div class="field-group">
      <label>Beneficiary Bank / Banco Beneficiario *</label>
      <input type="text" id="bancoBeneficiario" placeholder="Bank name">
    </div>
    <div class="row-2">
      <div class="field-group">
        <label>Swift (Beneficiary) *</label>
        <input type="text" id="swiftBeneficiario" placeholder="e.g. BNPAFRPP">
      </div>
      <div class="field-group">
        <label>IBAN / Account *</label>
        <input type="text" id="ibanBeneficiario" placeholder="e.g. FR76...">
      </div>
    </div>
    <div class="field-group">
      <label>Bank Address / DirecciÃ³n del Banco</label>
      <input type="text" id="dirBanco" placeholder="Full address of beneficiary bank">
    </div>

    <div class="section-title">Your Details / Sus Datos</div>
    <div class="row-2">
      <div class="field-group">
        <label>Your Name *</label>
        <input type="text" id="submitterName" placeholder="Full name">
      </div>
      <div class="field-group">
        <label>Your Email *</label>
        <input type="email" id="submitterEmail" placeholder="your@email.com">
      </div>
    </div>
    <div class="field-group">
      <label>Reference / Concepto</label>
      <input type="text" id="referencia" placeholder="Invoice number, project, etc.">
    </div>

    <div class="disclaimer">
      <strong>âš  Important Notice / Aviso Importante</strong>
      By submitting this form, you confirm all banking details are accurate. Verdi Square Asset Management SL will execute the transfer strictly per these instructions and cannot be held responsible for delayed, misdirected, or incomplete payments due to incorrect information provided.
      <br><br>
      Al enviar este formulario confirma que todos los datos son correctos. Verdi Square Asset Management SL ejecutarÃ¡ la transferencia segÃºn estas instrucciones y no asume responsabilidad por retrasos o pagos incorrectos derivados de informaciÃ³n errÃ³nea del remitente.
    </div>

    <button class="submit-btn" id="submitBtn" onclick="submitForm()">
      Enviar Solicitud Â· Send Request
    </button>
    <div class="error-msg" id="errorMsg"></div>
  </div>

  <div class="card success-screen" id="successCard">
    <div class="success-icon">âœ“</div>
    <h2>Request Submitted</h2>
    <p>Your wire transfer request has been sent for processing.</p>
    <div class="ref-box" id="refNumber">â€“</div>
    <table class="summary-table" id="summaryTable"></table>
    <div class="invoice-notice">
      <strong>ðŸ“Ž Please email your invoice</strong>
      Send your invoice to <strong>pagos@onix-cp.com</strong> with reference <strong id="refInEmail">â€“</strong> in the subject line.
    </div>
    <button class="new-btn" onclick="resetForm()">Nueva Solicitud Â· New Request</button>
  </div>

</div>

<script>
  function fmt(n) {
    return new Intl.NumberFormat('es-ES', {minimumFractionDigits:2, maximumFractionDigits:2}).format(n);
  }

  function today() {
    return new Date().toLocaleDateString('es-ES', {day:'2-digit', month:'long', year:'numeric'});
  }

  function refCode() {
    return 'VSQ-' + Date.now().toString(36).toUpperCase();
  }

  function g(id) { return document.getElementById(id).value.trim(); }

  function showError(msg) {
    var el = document.getElementById('errorMsg');
    el.textContent = msg;
    el.style.display = 'block';
  }

  function validate() {
    var checks = [
      ['amount', 'Amount is required'],
      ['beneficiario', 'Beneficiary name is required'],
      ['dirBeneficiario', 'Beneficiary address is required'],
      ['bancoBeneficiario', 'Beneficiary bank is required'],
      ['swiftBeneficiario', 'Swift code is required'],
      ['ibanBeneficiario', 'IBAN / Account is required'],
      ['submitterName', 'Your name is required'],
      ['submitterEmail', 'Your email is required']
    ];
    for (var i = 0; i < checks.length; i++) {
      if (!document.getElementById(checks[i][0]).value.trim()) return checks[i][1];
    }
    if (parseFloat(g('amount')) <= 0) return 'Enter a valid amount';
    return null;
  }

  async function submitForm() {
    document.getElementById('errorMsg').style.display = 'none';
    var err = validate();
    if (err) { showError(err); return; }

    var btn = document.getElementById('submitBtn');
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner"></span>Procesando...';

    var ref = refCode();

    var data = {
      ref: ref,
      date: today(),
      amount: parseFloat(g('amount')),
      currency: g('currency'),
      beneficiario: g('beneficiario'),
      dirBeneficiario: g('dirBeneficiario'),
      bancoIntermediario: g('bancoIntermediario') || 'â€“',
      ciudadIntermediario: g('ciudadIntermediario') || 'â€“',
      swiftIntermediario: g('swiftIntermediario').toUpperCase() || 'â€“',
      aba: g('aba') || 'â€“',
      bancoBeneficiario: g('bancoBeneficiario'),
      swiftBeneficiario: g('swiftBeneficiario').toUpperCase(),
      ibanBeneficiario: g('ibanBeneficiario'),
      dirBanco: g('dirBanco') || 'â€“',
      submitterName: g('submitterName'),
      submitterEmail: g('submitterEmail'),
      referencia: g('referencia') || 'â€“'
    };

    try {
      var response = await fetch('/api/submit', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      var result = await response.json();

      if (!response.ok) {
        throw new Error(result.error || 'Submission failed');
      }

      // Show success
      document.getElementById('refNumber').textContent = ref;
      document.getElementById('refInEmail').textContent = ref;

      var rows = [
        ['Beneficiario', data.beneficiario],
        ['Importe', fmt(data.amount) + ' ' + data.currency],
        ['Banco', data.bancoBeneficiario],
        ['Swift', data.swiftBeneficiario],
        ['IBAN/Cuenta', data.ibanBeneficiario],
        ['Referencia', data.referencia],
        ['Enviado por', data.submitterName + ' (' + data.submitterEmail + ')']
      ];

      document.getElementById('summaryTable').innerHTML = rows.map(function(r) {
        return '<tr><td>' + r[0] + '</td><td><strong>' + r[1] + '</strong></td></tr>';
      }).join('');

      document.getElementById('formCard').style.display = 'none';
      document.getElementById('successCard').style.display = 'block';
      window.scrollTo(0, 0);

    } catch(e) {
      showError('Error: ' + e.message + '. Please try again.');
      btn.disabled = false;
      btn.innerHTML = 'Enviar Solicitud Â· Send Request';
    }
  }

  function resetForm() {
    document.querySelectorAll('input').forEach(function(el) { el.value = ''; });
    document.getElementById('currency').selectedIndex = 0;
    document.getElementById('formCard').style.display = 'block';
    document.getElementById('successCard').style.display = 'none';
    document.getElementById('submitBtn').disabled = false;
    document.getElementById('submitBtn').textContent = 'Enviar Solicitud Â· Send Request';
    document.getElementById('errorMsg').style.display = 'none';
    window.scrollTo(0, 0);
  }
</script>
</body>
</html>
